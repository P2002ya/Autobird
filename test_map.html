<!DOCTYPE html>
<html>
<head>
  <title>AutoBird - Select Pickup Location</title>
  <style>
    #map {
      height: 400px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h2>Select Pickup Location on the Map</h2>
  <div id="map"></div>

  <form action="assign_driver.php" method="POST">
    <input type="hidden" id="pickup_lat" name="pickup_lat">
    <input type="hidden" id="pickup_lng" name="pickup_lng">
    <button type="submit">Book Auto</button>
  </form>

  <p id="locationText"></p>

  <script>
    function initMap() {
      const belgaum = { lat: 15.8497, lng: 74.4977 };

      const map = new google.maps.Map(document.getElementById("map"), {
        zoom: 13,
        center: belgaum,
      });

      let marker;

      map.addListener("click", function (event) {
        const lat = event.latLng.lat();
        const lng = event.latLng.lng();

        // Show marker
        if (marker) marker.setMap(null);
        marker = new google.maps.Marker({
          position: { lat, lng },
          map: map,
        });

        // Fill hidden fields
        document.getElementById("pickup_lat").value = lat;
        document.getElementById("pickup_lng").value = lng;

        // Show lat/lng on screen
        document.getElementById("locationText").innerText =
          "Pickup: Lat " + lat.toFixed(5) + ", Lng " + lng.toFixed(5);
      });
    }
  </script>

  <!-- âœ… Replace YOUR_API_KEY below with your real key -->
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyACf77IVfYFMpQqlw0VU-XsHOyromXMR_M&callback=initMap"
          async defer></script>
</body>
</html>
